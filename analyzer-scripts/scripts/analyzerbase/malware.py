from .common import *
from .util import extract_ips, extract_urls

class Malware:
    malware_path = test_logs_path / "malware" / "downloads"
    def __init__(self, shasum) -> None:
        self.shasum = shasum
        self.filepath = self.malware_path / shasum

    @property
    def text(self):
        if self.filepath.exists():
            return self.filepath.open().read()
        else:
            return ""

    @property
    def lines(self):
        return self.text.split("\n")

    @property
    def urls(self):
        return extract_urls(self.text)
    

    @property
    def ips(self):
        return extract_ips(self.text)
    

    def __repr__(self) -> str:
        return f"Malware {self.shasum[:10]} with {len(self.lines)} lines, {len(self.urls)} urls, {len(self.ips)} ips"